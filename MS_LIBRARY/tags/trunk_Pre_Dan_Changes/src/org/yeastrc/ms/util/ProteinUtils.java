/**
 * ProteinUtils.java
 * @author Vagisha Sharma
 * Nov 3, 2009
 * @version 1.0
 */
package org.yeastrc.ms.util;

/**
 * 
 */
public class ProteinUtils {

    private ProteinUtils () {}

    /**
     * Returns the mass in daltons
     * @param sequence
     * @return
     */
    public static double calculateMolWt(String sequence) {
        sequence = sequence.trim().toUpperCase();
        double mass = 0;
        for(int i = 0; i < sequence.length(); i++) {
            mass += AminoAcidUtilsFactory.getProteinAminoAcidUtils().avgMass(sequence.charAt(i));
        }
        // add H for n-terminus and OH for c-terminus
        mass = (mass + BaseAminoAcidUtils.NTERM_MASS + BaseAminoAcidUtils.CTERM_MASS); //  / 1000.0; // kiloDaltons
        return Math.round(mass *100.0) / 100.0;
    }

    public static double calculatePi(String sequence) {
        return PiCalculator.calculatePi(sequence);
    }

    public static void main(String[] args) {
//      String sequence = " MTDKSIVILSLMVFHSSFINGKTCRRQLVEEWHPQPSSYVVNWTLTENICLDFYRDCWFLGVNTKIDTSGNQAVPQICPLQIQLGDILVISSEPSLQFPEINLMNVSETSFVGCVQNTTTEDQLLFGCRLKGMHTVNSKWLSVGTHYFITVMAS?GPSPCPLGLRLNVTVKQQFCQESLSSEFCSGHGKCLSEAWSKTYSCHCQPPFSGKYCQELDACSFKPCKNNGSCINKRENWDEQAYECVCHPPFTGKNCSEIIGQCQPHVCFHGNCSNITSNSFICECDEQFSGPFCEVSAKPCVSLLFWKRGICPNSSSAYTYECPKGSSSQNGETDVSEFSLVPCQNGTDCIKISNDVMCICSPIFTDLLCKSIQTSCESFPLRNNATCKKCEKDYPCSCISGFTEKNCEKAIDHCKLLSINCLNEEWCFNIIGRFKYVCIPGCTKNPCWFLKNVYLIHQHLCYCGVTFHGICQDKGPAQFEYVWQLGFAGSEGEKCQGVIDAYFFLAANCTEDATYVNDPEDNNSSCWFPHEGTKEICANGCSCLSEEDSQEYRYLCFLRWAGNMYLENTTDDQENECQHEAVCKDEINRPRCSCSLSYIGRLCVVNVDYCLGNHSISVHGLCLALSHNCNCSGLQRYERNICEIDTEDCKSASCKNGTTSTHLRGYFFRKCVPGFKGTQCEIDIDECASHPCKNGATCIDQPGNYFCQCVPPFKVVDGFSCLCNPGYVGIRCEQDIDDCILNACEHNSTCKDLHLSYQCVCLSDWEGNFCEQESNECKMNPCKNNSTCTDLYKSYRCECTSGWTGQNCSEEINECDSDPCMNGGLCHESTIPGQFVCLCPPLYTGQFCHQRYNPCDLLHNPCRNNSTCLALVDANQHCICREEFEGKNCEIDVKDCLFLSCQDYGDCEDMVNNFRCICRPGFSGSLCEIEINECSSEPCKNNGTCVDLTNRFFCNCEPEYHGPFCELDVNKCKISPCLDEENCVYRTDGYNCLCAPGYTGINCEINLDECLSEPCLHDGVCIDGINHYTCDCKSGFFGTHCETNANDCLSNPCLHGRCTELINEYPCSCDADGTSTQCKIKINDCTSIPCMNEGFCQKSAHGFTCICPRGYTGAYCEKSIDNCAEPELNSVICLNGGICVDGPGHTFDCRCLPGFSGQFCEININECSSSPCLHGADCEDHINGYVCKCQPGWSGHHCENELECIPNSCVHELCMENEPGSTCLCTPGFMTCSIGLLCGDEIRRITCLTPIFQRTDPISTQTYTIPPSETLVSSFPSIKATRIPAIMDTYPVDQGPKQTGIVKHDILPTTGLATLRISTPLESYLLQELIVTRELSAKHSLLSSADVSSSRFLNFGIRDPAQIVQDKTSVSHMPIRTSAATLGFFFPDRRARTPFIMSSLMSDFIFPTQSLLFENCQTVALSATPTTSVIRSIPGADIELNRQSLLSRGFLLIAASISATPVVSRGAQEDIEEYSADSLISRREHWRLLSPSMSPIFPAKVIISKQVTILNSSALHRFSTKAFNPSEYQAITEASSNQRLTNIKSQAADSLRELSQTCATCSMTEIKSSREFSDQVLHSKQSHFYETFWMNSAILASWYALMGAQTITSGHSFSSATEITPSVAFTEVPSLFPSKKSAKRTILSSSLEESITLSSNLDVNLCLDKTCLSIVPSQTISSDLMNSDLTSKMTTDELSVSENILKLLKIRQYGITMGPTEVLNQESLLDMEKSKGSHTLFKLHPSDSSLDFELNLQIYPDVTLKTYSEITHANDFKNNLPPLTGSVPDFSEVTTNVAFYTVSATPALSIQTSSSMSVIRPDWPYFTDYMTSLKKEVKTSSEWSKWELQPSVQYQEFPTASRHLPFTRSLTLSSLESILAPQRLMISDFSCVRYYGDSYLEFQNVALNPQNNISLEFQTFSSYGLLLYVKQDSNLVDGFFIQLFIENGTLKYHFYCPGEAKFKSINTTVRVDNGQKYTLLIRQELDPCNAELTILGRNTQICESINHVLGKPLPKSGSVFIGGFPDLHGKIQMPVPVKNFTGCIEVIEINNWRSFIPSKAVKNYHINNCRSQGFMLSPTASFVDASDVTQGVDTMWTSVSPSVAAPSVCQQDVCHNGGTCHAIFLSSGIVSFQCDCPLHFTGRFCEKDAGLFFPSFNGNSYLELPFLKFVLEKEHNRTVTIYLTIKTNSLNGTILYSNGNNCGKQFLHLFLVEGRPSVKYGCGNSQNILTVSANYSINTNAFTPITIRYTTPVGSPGVVCMIEMTADGKPPVQKKDTEISHASQAYFESMFLGHIPANVQIHKKAGPVYGFRGCILDLQVNNKEFFIIDEARHGKNIENCHVPWCAHHLCRNNGTCISDNENLFCECPRLYSGKLCQFASCENNPCGNGATCVPKSGTDIVCLCPYGRSGPLCTDAINITQPRFSGTDAFGYTSFLAYSRISDISFHYEFHLKFQLANNHSALQNNLIFFTGQKGHGLNGDDFLAVGLLNGSVVYSYNLGSGIASIRSEPLNLSLGVHTVHLGKFFQEGWLKVDDHKNKSIIAPGRLVGLNVFSQFYVGGYSEYTPDLLPNGADFKNGFQGCIFTLQVRTEKDGHFRGLGNPEGHPNAGRSVGQCHASPCSLMKCGNGGTCIESGTSVYCNCTTGWKGSFCTETVSTCDPEHDPPHHCSRGATCISLPHGYTCFCPLGTTGIYCEQALILIVILEKPKPAERKVKKEALSISDPSFRSNELSWMSFASFHVRKKTHIQLQFQPLAADGILFYAAQHLKAQSGDFLCISLVNSSVQLRYNLGDRTIILETLQKVTINGSTWHIIKAGRVGAEGYLDLDGINVTEKASTKMSSLDTNTDFYIGGVSSLNLVNPMAIENEPVGFQGCIRQVIINNQELQLTEFGAKGGSNVGDCDGTACGYNTCRNGGECTVNGTTFSCRCLPDWAGNTCNQSVSCLNNLCLHQSLCIPDQSFSYSCLCTLGWVGRYCENKTSFSTAKFMGNSYIKYIDPNYRMRNLQFTTISLNFSTTKTEGLIVWMGIAQNEENDFLAIGLHNQTLKIAVNLGERISVPMSYNNGTFCCNKWHHVVVIQNQTLIKAYINNSLILSEDIDPHKNFVALNYDGICYLGGFEYGRKVNIVTQEIFKTNFVGKIKDVVFFQEPKNIELIKLEGYNVYDGDEQNEVT";
//      String sequence = "MAPGWPSLSAGSRQEAPQLAAGGSAYQAVGRQFQPRATALQGPSQAKSCICHVCGVHLNRLHSCLYCVFFGCFTKKHIHEHAKAKRHNLAIDLMYGGIYCFLCQDYIYDKDMEIIAKEEQRKAWKMQGVGEKFSTWEPTKRELELLKHNPKRRKITSNCTIGLRGLINLGNTCFMNCIVQALTHTPLLRDFFLSDRHRCEMQSPSSCLVCEMSSLFQEFYSGHRSPHIPYKLLHLVWTHARHLAGYEQQDAHEFLIAALDVLHRHCKGDDNGKKANNPNHCNCIIDQIFTGGLQSDVTCQVCHGVSTTIDPFWDISLDLPGSSTPFWPLSPGSEGNVVNGESHVSGTTTLTDCLRRFTRPEHLGSSAKIKCSGCHSYQESTKQLTMKKLPIVACFHLKRFEHSAKLRRKITTYVSFPLELDMTPFMASSKESRMNGQYQQPTDSLNNDNKYSLFAVVNHQGTLESGHYTSFIRQHKDQWFKCDDAIITKASIKDVLDSEGYLLFYHKQFLEYE ";
//      String sequence = "MAAPEQPLAISRGCTSSSSLSPPRGDRTLLVRHLPAELTAEEKEDLLKYFGAQSVRVLSDKGRLKHTAFATFPNEKAAIKSFSRL";
//      String sequence = "MAAKRSSGAAPAPASASAPAPVPGGEAERVRVFHKQAFEYISIALRIDEDEKAGQKEQAVEWYKKGIEELEKGIAVIVTGQGEQCERARRLQAKMMTNLVMAKDRLQLLEKMQPVLPFSKSQTDVYNDSTNLACRNGHLQSESGAVPKRKDPLTHTSNSLPRSKTVMKTGSAGLSGHHRAPSYSGLSMVSGVKQGSGPAPTTHKGTPKTNRTNKPSTPTTATRKKKDLKNFRNVDSNLANLIMNEIVDNGTAVKFDDIAGQDLAKQALQEIVILPSLRPELFTGLRAPARGLLLFGPPGNGKTMLAKAVAAESNATFFNISAASLTSKYVGEGEKLVRALFAVARELQPSIIFIDEVDSLLCERREGEHDASRRLKTEFLIEFDGVQSAGDDRVLVMGATNRPQELDEAVLRRFIKRVYVSLPNEETRLLLLKNLLCKQGSPLTQKELAQLARMTDGYSGSDLTALAKDAALGPIRELKPEQVKNMSASEMRNIRLSDFTESLKKIKRSVSPQTLEAYIRWNKDFGDTTV";
        String sequence = "XPDGRLLRGHDQSAYDGKDYIALNEDLSSWTAADTAAQITQRKWEAARVAEQLRAYLEGTCVEWLRRHLENGKETLQRADPPKTHVTHHPISDHEATLRCWALGFYPAEITLTWQRDGEDQTQDTELVETRPAGDRTFQKWAAVVVPSGEEQRYTCHVQHEGLPKPLTLRWEPSSQSTIPIVGIVAGLAVLAVVVIGAVVATVMCRRKSSGHFLPTGGKGGSYSQAASSDSAQGSDVSLTA";
        System.out.println("Length: "+sequence.length());
        System.out.println("MolWt: "+ProteinUtils.calculateMolWt(sequence));
        System.out.println("pI: "+PiCalculator.calculatePi(sequence));
    }
}
