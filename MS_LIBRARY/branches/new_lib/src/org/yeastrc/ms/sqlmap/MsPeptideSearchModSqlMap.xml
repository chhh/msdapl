<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
      "http://ibatis.apache.org/dtd/sql-map-2.dtd"> 
<sqlMap namespace="MsSearchMod"> 


	<typeAlias alias="MsSearchDynaMod" type="org.yeastrc.ms.dto.MsSearchDynamicMod"/>
	<typeAlias alias="MsSearchMod" type="org.yeastrc.ms.dto.MsSearchMod"/>
	
	
	<resultMap class="MsSearchMod" id="msModResult">
		<result property="id" column="id"/>
		<result property="searchID" column="searchID"/>
		<result property="modifiedResidue" column="residue" javaType="java.lang.String"/>
		<result property="modificationMass" column="modifier"/>
	</resultMap>
	
	<!-- if symbol is NULL we will return an empty String and the default value (\u0000)
	     for modificationSymbol will be used 
	-->
	<resultMap class="MsSearchDynaMod" extends="MsSearchMod" id="msDynaModResult">
		<result property="modificationSymbol" column="symbol" javaType="java.lang.String" nullValue=""/>
	</resultMap>
	
	
	<parameterMap class="MsSearchMod" id="msModParam">
		<parameter property="searchId" jdbcType="INTEGER"/>
		<parameter property="modifiedResidue" jdbcType="CHAR"/>
		<parameter property="modificationMass" jdbcType="DECIMAL"/>
	</parameterMap>
	
	<parameterMap class="MsDynaSearchMod" id="msDynaModParam">
		<parameter property="searchId" jdbcType="INTEGER"/>
		<parameter property="modifiedResidue" jdbcType="CHAR"/>
		<parameter property="modificationMass" jdbcType="DECIMAL"/>
		<parameter property="modificationSymbol" jdbcType="CHAR"/>
	</parameterMap>
	
	<!-- ================================================================================= -->
	<!-- QUERIES FOR STATIC MODIFICATIONS -->
	<!-- ================================================================================= -->
    <select id="selectStaticModsForSearch" resultMap="msModResult" parameterClass="Integer">
    	SELECT * FROM msPeptideSearchStaticMod WHERE searchID= #id#
    </select>
    
    <insert id="insert" parameterMap="msModParam">
    	INSERT INTO msPeptideSearchStaticMod (
    	searchID,
    	modifiedResidue,
    	modificationMass)
    	VALUES (?,?,?)
    </insert>
    
    <delete id="deleteStaticModsForSearch" parameterClass="Integer">
		DELETE FROM msPeptideSearchStaticMod WHERE searchID=#id#
    </delete>
    
	
	<!-- ================================================================================= -->
	<!-- QUERIES FOR STATIC MODIFICATIONS -->
	<!-- ================================================================================= -->
    <select id="selectDynaModsForSearch" resultMap="msDynaModResult" parameterClass="Integer">
    	SELECT * FROM msPeptideSearchDynamicMod WHERE searchID= #id#
    </select>
    
    
    <insert id="insert" parameterMap="msDynaModParam">
    	INSERT INTO msPeptideSearchDynamicMod (
    	searchID,
    	modifiedResidue,
    	modificationMass,
    	symbol)
    	VALUES (?,?,?,?)
    </insert>
    
    <delete id="deleteForSearchId" parameterClass="Integer">
		DELETE FROM msPeptideSearchDynamicMod WHERE searchID=#id#
    </delete>
    
</sqlMap>